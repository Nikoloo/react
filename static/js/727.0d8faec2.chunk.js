"use strict";(self.webpackChunkspotify_webapp=self.webpackChunkspotify_webapp||[]).push([[499,727],{499:(e,t,r)=>{r.d(t,{A:()=>s,spotifyAuth:()=>a});class o{constructor(e){this.clientId=void 0,this.redirectUri=void 0,this.scopes=void 0,this.codeVerifier="",this.clientId=e.clientId,this.redirectUri=e.redirectUri,this.scopes=e.scopes}generateCodeVerifier(){const e=new Uint8Array(32);return crypto.getRandomValues(e),btoa(String.fromCharCode.apply(null,Array.from(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}async generateCodeChallenge(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t);return btoa(String.fromCharCode.apply(null,Array.from(new Uint8Array(r)))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}async initiateAuth(){this.codeVerifier=this.generateCodeVerifier();const e=await this.generateCodeChallenge(this.codeVerifier);localStorage.setItem("spotify_code_verifier",this.codeVerifier);const t=`https://accounts.spotify.com/authorize?${new URLSearchParams({client_id:this.clientId,response_type:"code",redirect_uri:this.redirectUri,code_challenge_method:"S256",code_challenge:e,scope:this.scopes.join(" "),state:this.generateState()}).toString()}`;window.location.href=t}generateState(){const e=new Uint8Array(16);crypto.getRandomValues(e);const t=btoa(String.fromCharCode.apply(null,Array.from(e)));return localStorage.setItem("spotify_auth_state",t),t}async handleCallback(e,t){if(t!==localStorage.getItem("spotify_auth_state"))throw new Error("Invalid state parameter");const r=localStorage.getItem("spotify_code_verifier");if(!r)throw new Error("Code verifier not found");const o=await this.exchangeCodeForToken(e,r);return localStorage.removeItem("spotify_code_verifier"),localStorage.removeItem("spotify_auth_state"),this.storeTokens(o),o}async exchangeCodeForToken(e,t){const r=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",code:e,redirect_uri:this.redirectUri,client_id:this.clientId,code_verifier:t})});if(!r.ok){const e=await r.json();throw new Error(`Token exchange failed: ${e.error_description}`)}return r.json()}async refreshToken(){const e=localStorage.getItem("spotify_refresh_token");if(!e)throw new Error("No refresh token available");const t=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:e,client_id:this.clientId})});if(!t.ok){const e=await t.json();throw new Error(`Token refresh failed: ${e.error_description}`)}const r=await t.json();return this.storeTokens(r),r}storeTokens(e){const t=Date.now()+1e3*e.expires_in;localStorage.setItem("spotify_access_token",e.access_token),localStorage.setItem("spotify_token_expiration",t.toString()),e.refresh_token&&localStorage.setItem("spotify_refresh_token",e.refresh_token)}async getValidToken(){const e=localStorage.getItem("spotify_access_token"),t=localStorage.getItem("spotify_token_expiration");if(!e||!t)return null;if(Date.now()>parseInt(t)-3e5)try{return(await this.refreshToken()).access_token}catch(r){return console.error("Token refresh failed:",r),this.logout(),null}return e}isAuthenticated(){const e=localStorage.getItem("spotify_access_token"),t=localStorage.getItem("spotify_token_expiration");return!(!e||!t)&&Date.now()<parseInt(t)}async getCurrentUser(){const e=await this.getValidToken();if(!e)throw new Error("No valid token available");const t=await fetch("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw new Error("Failed to get user data");return t.json()}logout(){localStorage.removeItem("spotify_access_token"),localStorage.removeItem("spotify_refresh_token"),localStorage.removeItem("spotify_token_expiration"),localStorage.removeItem("spotify_code_verifier"),localStorage.removeItem("spotify_auth_state")}static parseCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=new URLSearchParams(new URL(e).search);return{code:t.get("code")||void 0,state:t.get("state")||void 0,error:t.get("error")||void 0}}}const a=new o({clientId:"b77eca5b73724310ac6499de78621e58",redirectUri:"https://nikoloo.github.io/react/callbackk",scopes:["user-read-private","user-read-email","user-library-read","user-library-modify","user-read-playback-state","user-modify-playback-state","user-read-currently-playing","playlist-read-private","playlist-modify-private","playlist-modify-public","user-follow-read","user-follow-modify","user-read-recently-played","user-top-read"]}),s=o},727:(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});r(950);var o=r(499),a=r(414);const s=e=>{let{onLogin:t,className:r=""}=e;return(0,a.jsxs)("button",{className:`login-button ${r}`,onClick:async()=>{try{t&&t(),await o.spotifyAuth.initiateAuth()}catch(e){console.error("Login failed:",e)}},type:"button",children:[(0,a.jsx)("span",{className:"login-button__icon",children:(0,a.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.48.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"})})}),(0,a.jsx)("span",{className:"login-button__text",children:"Login with Spotify"})]})},i=()=>(0,a.jsxs)("div",{className:"login-page",children:[(0,a.jsx)("div",{className:"login-page__container",children:(0,a.jsxs)("div",{className:"login-page__content",children:[(0,a.jsxs)("div",{className:"login-page__header",children:[(0,a.jsx)("div",{className:"login-page__logo",children:(0,a.jsx)("svg",{width:"60",height:"60",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.48.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"})})}),(0,a.jsx)("h1",{className:"login-page__title",children:"Welcome to Spotify Web"}),(0,a.jsx)("p",{className:"login-page__subtitle",children:"Discover new music and enjoy your favorite tracks"})]}),(0,a.jsxs)("div",{className:"login-page__form",children:[(0,a.jsx)(s,{}),(0,a.jsx)("div",{className:"login-page__divider",children:(0,a.jsx)("span",{children:"or"})}),(0,a.jsx)("button",{className:"login-page__demo-button",children:"Continue as Guest"})]}),(0,a.jsxs)("div",{className:"login-page__features",children:[(0,a.jsxs)("div",{className:"feature",children:[(0,a.jsx)("span",{className:"feature__icon",children:"\ud83c\udfb5"}),(0,a.jsx)("span",{className:"feature__text",children:"Millions of songs"})]}),(0,a.jsxs)("div",{className:"feature",children:[(0,a.jsx)("span",{className:"feature__icon",children:"\ud83d\udcf1"}),(0,a.jsx)("span",{className:"feature__text",children:"Works on all devices"})]}),(0,a.jsxs)("div",{className:"feature",children:[(0,a.jsx)("span",{className:"feature__icon",children:"\u26a1"}),(0,a.jsx)("span",{className:"feature__text",children:"Fast and responsive"})]})]}),(0,a.jsx)("div",{className:"login-page__footer",children:(0,a.jsx)("p",{children:"By continuing, you agree to our Terms of Service and Privacy Policy."})})]})}),(0,a.jsxs)("div",{className:"login-page__background",children:[(0,a.jsx)("div",{className:"background-circle background-circle--1"}),(0,a.jsx)("div",{className:"background-circle background-circle--2"}),(0,a.jsx)("div",{className:"background-circle background-circle--3"})]})]})}}]);