{"version":3,"file":"static/js/437.a7871601.chunk.js","mappings":"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","sources":["components/Auth/LoginButton.tsx","components/Auth/LoginPage.tsx","services/auth/spotifyAuth.ts"],"sourcesContent":["import React from 'react';\r\nimport { spotifyAuth } from '../../services/auth/spotifyAuth';\r\nimport './LoginButton.scss';\r\n\r\ninterface LoginButtonProps {\r\n  onLogin?: () => void;\r\n  className?: string;\r\n}\r\n\r\nconst LoginButton: React.FC<LoginButtonProps> = ({ onLogin, className = '' }) => {\r\n  const handleLogin = async () => {\r\n    try {\r\n      if (onLogin) {\r\n        onLogin();\r\n      }\r\n      await spotifyAuth.initiateAuth();\r\n    } catch (error) {\r\n      console.error('Login failed:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <button \r\n      className={`login-button ${className}`}\r\n      onClick={handleLogin}\r\n      type=\"button\"\r\n    >\r\n      <span className=\"login-button__icon\">\r\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n          <path d=\"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.48.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z\"/>\r\n        </svg>\r\n      </span>\r\n      <span className=\"login-button__text\">Login with Spotify</span>\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default LoginButton;","import React from 'react';\r\nimport LoginButton from './LoginButton';\r\nimport './LoginPage.scss';\r\n\r\nconst LoginPage: React.FC = () => {\r\n  return (\r\n    <div className=\"login-page\">\r\n      <div className=\"login-page__container\">\r\n        <div className=\"login-page__content\">\r\n          {/* Logo and branding */}\r\n          <div className=\"login-page__header\">\r\n            <div className=\"login-page__logo\">\r\n              <svg width=\"60\" height=\"60\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                <path d=\"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.48.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z\"/>\r\n              </svg>\r\n            </div>\r\n            <h1 className=\"login-page__title\">Welcome to Spotify Web</h1>\r\n            <p className=\"login-page__subtitle\">\r\n              Discover new music and enjoy your favorite tracks\r\n            </p>\r\n          </div>\r\n\r\n          {/* Login form */}\r\n          <div className=\"login-page__form\">\r\n            <LoginButton />\r\n            \r\n            <div className=\"login-page__divider\">\r\n              <span>or</span>\r\n            </div>\r\n            \r\n            <button className=\"login-page__demo-button\">\r\n              Continue as Guest\r\n            </button>\r\n          </div>\r\n\r\n          {/* Features */}\r\n          <div className=\"login-page__features\">\r\n            <div className=\"feature\">\r\n              <span className=\"feature__icon\">ðŸŽµ</span>\r\n              <span className=\"feature__text\">Millions of songs</span>\r\n            </div>\r\n            <div className=\"feature\">\r\n              <span className=\"feature__icon\">ðŸ“±</span>\r\n              <span className=\"feature__text\">Works on all devices</span>\r\n            </div>\r\n            <div className=\"feature\">\r\n              <span className=\"feature__icon\">âš¡</span>\r\n              <span className=\"feature__text\">Fast and responsive</span>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <div className=\"login-page__footer\">\r\n            <p>\r\n              By continuing, you agree to our Terms of Service and Privacy Policy.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Background decoration */}\r\n      <div className=\"login-page__background\">\r\n        <div className=\"background-circle background-circle--1\"></div>\r\n        <div className=\"background-circle background-circle--2\"></div>\r\n        <div className=\"background-circle background-circle--3\"></div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoginPage;","// Spotify OAuth 2.0 with PKCE implementation\r\n\r\ninterface SpotifyAuthConfig {\r\n  clientId: string;\r\n  redirectUri: string;\r\n  scopes: string[];\r\n}\r\n\r\ninterface TokenResponse {\r\n  access_token: string;\r\n  token_type: string;\r\n  expires_in: number;\r\n  refresh_token?: string;\r\n  scope: string;\r\n}\r\n\r\nclass SpotifyAuthService {\r\n  private clientId: string;\r\n  private redirectUri: string;\r\n  private scopes: string[];\r\n  private codeVerifier: string = '';\r\n\r\n  constructor(config: SpotifyAuthConfig) {\r\n    this.clientId = config.clientId;\r\n    this.redirectUri = config.redirectUri;\r\n    this.scopes = config.scopes;\r\n  }\r\n\r\n  /**\r\n   * Generate code verifier for PKCE\r\n   */\r\n  private generateCodeVerifier(): string {\r\n    const array = new Uint8Array(32);\r\n    crypto.getRandomValues(array);\r\n    return btoa(String.fromCharCode.apply(null, Array.from(array)))\r\n      .replace(/\\+/g, '-')\r\n      .replace(/\\//g, '_')\r\n      .replace(/=/g, '');\r\n  }\r\n\r\n  /**\r\n   * Generate code challenge from verifier\r\n   */\r\n  private async generateCodeChallenge(verifier: string): Promise<string> {\r\n    const encoder = new TextEncoder();\r\n    const data = encoder.encode(verifier);\r\n    const digest = await crypto.subtle.digest('SHA-256', data);\r\n    return btoa(String.fromCharCode.apply(null, Array.from(new Uint8Array(digest))))\r\n      .replace(/\\+/g, '-')\r\n      .replace(/\\//g, '_')\r\n      .replace(/=/g, '');\r\n  }\r\n\r\n  /**\r\n   * Start OAuth flow - redirect to Spotify\r\n   */\r\n  async initiateAuth(): Promise<void> {\r\n    // Generate PKCE parameters\r\n    this.codeVerifier = this.generateCodeVerifier();\r\n    const codeChallenge = await this.generateCodeChallenge(this.codeVerifier);\r\n\r\n    // Store code verifier for later use\r\n    localStorage.setItem('spotify_code_verifier', this.codeVerifier);\r\n\r\n    // Build authorization URL\r\n    const params = new URLSearchParams({\r\n      client_id: this.clientId,\r\n      response_type: 'code',\r\n      redirect_uri: this.redirectUri,\r\n      code_challenge_method: 'S256',\r\n      code_challenge: codeChallenge,\r\n      scope: this.scopes.join(' '),\r\n      state: this.generateState(),\r\n    });\r\n\r\n    const authUrl = `https://accounts.spotify.com/authorize?${params.toString()}`;\r\n    \r\n    // Redirect to Spotify\r\n    window.location.href = authUrl;\r\n  }\r\n\r\n  /**\r\n   * Generate random state for security\r\n   */\r\n  private generateState(): string {\r\n    const array = new Uint8Array(16);\r\n    crypto.getRandomValues(array);\r\n    const state = btoa(String.fromCharCode.apply(null, Array.from(array)));\r\n    localStorage.setItem('spotify_auth_state', state);\r\n    return state;\r\n  }\r\n\r\n  /**\r\n   * Handle OAuth callback and exchange code for token\r\n   */\r\n  async handleCallback(code: string, state: string): Promise<TokenResponse> {\r\n    // Verify state parameter\r\n    const storedState = localStorage.getItem('spotify_auth_state');\r\n    if (state !== storedState) {\r\n      throw new Error('Invalid state parameter');\r\n    }\r\n\r\n    // Get stored code verifier\r\n    const codeVerifier = localStorage.getItem('spotify_code_verifier');\r\n    if (!codeVerifier) {\r\n      throw new Error('Code verifier not found');\r\n    }\r\n\r\n    // Exchange code for token\r\n    const tokenData = await this.exchangeCodeForToken(code, codeVerifier);\r\n\r\n    // Clean up stored values\r\n    localStorage.removeItem('spotify_code_verifier');\r\n    localStorage.removeItem('spotify_auth_state');\r\n\r\n    // Store tokens with expiration\r\n    this.storeTokens(tokenData);\r\n\r\n    return tokenData;\r\n  }\r\n\r\n  /**\r\n   * Exchange authorization code for access token\r\n   */\r\n  private async exchangeCodeForToken(code: string, codeVerifier: string): Promise<TokenResponse> {\r\n    const response = await fetch('https://accounts.spotify.com/api/token', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n      },\r\n      body: new URLSearchParams({\r\n        grant_type: 'authorization_code',\r\n        code,\r\n        redirect_uri: this.redirectUri,\r\n        client_id: this.clientId,\r\n        code_verifier: codeVerifier,\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json();\r\n      throw new Error(`Token exchange failed: ${errorData.error_description}`);\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  /**\r\n   * Refresh access token using refresh token\r\n   */\r\n  async refreshToken(): Promise<TokenResponse> {\r\n    const refreshToken = localStorage.getItem('spotify_refresh_token');\r\n    if (!refreshToken) {\r\n      throw new Error('No refresh token available');\r\n    }\r\n\r\n    const response = await fetch('https://accounts.spotify.com/api/token', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n      },\r\n      body: new URLSearchParams({\r\n        grant_type: 'refresh_token',\r\n        refresh_token: refreshToken,\r\n        client_id: this.clientId,\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json();\r\n      throw new Error(`Token refresh failed: ${errorData.error_description}`);\r\n    }\r\n\r\n    const tokenData = await response.json();\r\n    this.storeTokens(tokenData);\r\n    return tokenData;\r\n  }\r\n\r\n  /**\r\n   * Store tokens with expiration time\r\n   */\r\n  private storeTokens(tokenData: TokenResponse): void {\r\n    const expirationTime = Date.now() + (tokenData.expires_in * 1000);\r\n    \r\n    localStorage.setItem('spotify_access_token', tokenData.access_token);\r\n    localStorage.setItem('spotify_token_expiration', expirationTime.toString());\r\n    \r\n    if (tokenData.refresh_token) {\r\n      localStorage.setItem('spotify_refresh_token', tokenData.refresh_token);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current access token, refresh if needed\r\n   */\r\n  async getValidToken(): Promise<string | null> {\r\n    const token = localStorage.getItem('spotify_access_token');\r\n    const expirationTime = localStorage.getItem('spotify_token_expiration');\r\n\r\n    if (!token || !expirationTime) {\r\n      return null;\r\n    }\r\n\r\n    // Check if token is expired (with 5 minute buffer)\r\n    const isExpired = Date.now() > (parseInt(expirationTime) - 300000);\r\n\r\n    if (isExpired) {\r\n      try {\r\n        const newTokenData = await this.refreshToken();\r\n        return newTokenData.access_token;\r\n      } catch (error) {\r\n        console.error('Token refresh failed:', error);\r\n        this.logout();\r\n        return null;\r\n      }\r\n    }\r\n\r\n    return token;\r\n  }\r\n\r\n  /**\r\n   * Check if user is authenticated\r\n   */\r\n  isAuthenticated(): boolean {\r\n    const token = localStorage.getItem('spotify_access_token');\r\n    const expirationTime = localStorage.getItem('spotify_token_expiration');\r\n    \r\n    if (!token || !expirationTime) {\r\n      return false;\r\n    }\r\n\r\n    return Date.now() < parseInt(expirationTime);\r\n  }\r\n\r\n  /**\r\n   * Get current user from Spotify API\r\n   */\r\n  async getCurrentUser() {\r\n    const token = await this.getValidToken();\r\n    if (!token) {\r\n      throw new Error('No valid token available');\r\n    }\r\n\r\n    const response = await fetch('https://api.spotify.com/v1/me', {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to get user data');\r\n    }\r\n\r\n    return response.json();\r\n  }\r\n\r\n  /**\r\n   * Logout user and clear tokens\r\n   */\r\n  logout(): void {\r\n    localStorage.removeItem('spotify_access_token');\r\n    localStorage.removeItem('spotify_refresh_token');\r\n    localStorage.removeItem('spotify_token_expiration');\r\n    localStorage.removeItem('spotify_code_verifier');\r\n    localStorage.removeItem('spotify_auth_state');\r\n  }\r\n\r\n  /**\r\n   * Parse URL parameters from OAuth callback\r\n   */\r\n  static parseCallback(url: string = window.location.href): { code?: string; state?: string; error?: string } {\r\n    const urlParams = new URLSearchParams(new URL(url).search);\r\n    return {\r\n      code: urlParams.get('code') || undefined,\r\n      state: urlParams.get('state') || undefined,\r\n      error: urlParams.get('error') || undefined,\r\n    };\r\n  }\r\n}\r\n\r\n// Default configuration (can be overridden)\r\nconst defaultConfig: SpotifyAuthConfig = {\r\n  clientId: process.env.REACT_APP_SPOTIFY_CLIENT_ID || '',\r\n  redirectUri: process.env.REACT_APP_SPOTIFY_REDIRECT_URI || `${window.location.origin}/callback`,\r\n  scopes: [\r\n    'user-read-private',\r\n    'user-read-email',\r\n    'user-library-read',\r\n    'user-library-modify',\r\n    'user-read-playback-state',\r\n    'user-modify-playback-state',\r\n    'user-read-currently-playing',\r\n    'playlist-read-private',\r\n    'playlist-modify-private',\r\n    'playlist-modify-public',\r\n    'user-follow-read',\r\n    'user-follow-modify',\r\n    'user-read-recently-played',\r\n    'user-top-read',\r\n  ],\r\n};\r\n\r\n// Export singleton instance\r\nexport const spotifyAuth = new SpotifyAuthService(defaultConfig);\r\nexport default SpotifyAuthService;"],"names":["_ref","onLogin","className","_jsxs","onClick","async","spotifyAuth","initiateAuth","error","console","type","children","_jsx","width","height","viewBox","fill","d","LoginPage","LoginButton","SpotifyAuthService","constructor","config","clientId","redirectUri","scopes","codeVerifier","this","generateCodeVerifier","array","Uint8Array","crypto","getRandomValues","btoa","String","fromCharCode","apply","Array","from","replace","generateCodeChallenge","verifier","data","TextEncoder","encode","digest","subtle","codeChallenge","localStorage","setItem","authUrl","URLSearchParams","client_id","response_type","redirect_uri","code_challenge_method","code_challenge","scope","join","state","generateState","toString","window","location","href","handleCallback","code","getItem","Error","tokenData","exchangeCodeForToken","removeItem","storeTokens","response","fetch","method","headers","body","grant_type","code_verifier","ok","errorData","json","error_description","refreshToken","refresh_token","expirationTime","Date","now","expires_in","access_token","getValidToken","token","parseInt","logout","isAuthenticated","getCurrentUser","Authorization","parseCallback","url","arguments","length","undefined","urlParams","URL","search","get","process","REACT_APP_SPOTIFY_CLIENT_ID","REACT_APP_SPOTIFY_REDIRECT_URI","origin"],"sourceRoot":""}